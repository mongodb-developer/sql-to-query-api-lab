import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# üëê SELECT ‚Üí projection

In SQL, the `SELECT` statement allows us to specify which columns to retrieve from a table. Similarly, in MongoDB, we use **projection** in the `.find()` method to control which fields to include (or exclude) in query results.

## Syntax

```js
db.collection.find({ <query> }, { <projection> });
```

## **Projection basics**

- By default, MongoDB returns all fields in a document.
- Use projection to **include (1)** or **exclude (0)** specific fields.
- The `_id` field is always included unless explicitly excluded.
  1

## **Example 1: Retrieve only `title` and `authors` fields**

```js
db.books.find({}, { title: 1, authors: 1, _id: 0 });
```

**Equivalent SQL query:**

```sql
SELECT title, authors FROM books;
```

Here:

- `{}` means "match all documents."
- `{ title: 1, authors: 1, _id: 0 }` specifies that only `title` and `authors` should be returned, and `_id` should be excluded.

---

## **Example 2: Exclude the `reviews` field**

```js
db.books.find({}, { reviews: 0 });
```

**Equivalent SQL query:**

```sql
SELECT title, authors, genres, totalInventory, available FROM books;
```

Here:

- We are removing `reviews`, but all other fields will still appear.

---

## **Example 3: Using projection along with a query**

```js
db.books.find({ "genres": "Science" }, { title: 1, totalInventory: 1, _id: 0 });
```

**Equivalent SQL query:**

```sql
SELECT title, totalInventory FROM books WHERE genres='Science';
```

Here:

- We first **filter** books that belong to the "Science" genre.
- We then **select only** the `title` and `totalInventory` fields.

---

## **Challenge**

### üëê 1. Retrieve only the `title` field for all books.

<details>
  <summary>Answer</summary>
  <Tabs groupId="challenges" defaultValue={"javascript"}>
    <TabItem value="javascript" label="JavaScript">
      <div>
        ```js
        const cursor = await books.find({}).project( {title: 1, _id: 0} ).limit(10);

        await cursor.forEach((b) => {
            console.log(b);
        });
        ```
      </div>

    </TabItem>
    <TabItem value="mongosh" label="mongosh">
      <div>
        ```js
        db.books.find({}, {title: 1, _id: 0});
        ```
      </div>
    </TabItem>
     <TabItem value="csharp" label="C#">
      <div>
        ```csharp
       var projection = Builders<Book>.Projection.Include(b => b.Title).Exclude(b => b.Id);

      var booksWithOnlyTitle = booksCollection.Find(b => true).Project<Book>(projection).Limit(50).ToList();

      if(booksWithOnlyTitle != null)
      {
          foreach(var book in booksWithOnlyTitle)
          {
            Console.WriteLine(book.ToJson()); // Shows the entire BSON document as JSON to show that some fields are null because they are not returned due to the projection
          }
      }
      else
      {
          Console.WriteLine("Empty Collection");
      }
        ```
      </div>
    </TabItem>
  </Tabs>
</details>

### üëê 2. Retrieve all fields except `_id` and `authors` for books in the "History" genre.

<details>
  <summary>Answer</summary>
  <Tabs groupId="challenges" defaultValue={"javascript"}>
    <TabItem value="javascript" label="JavaScript">
      <div>
          ```js
          const cursor = await books.find({ "genres": "History" }).project( { _id: 0, authors: 0 } ).limit(10);

          await cursor.forEach((b) => {
              console.log(b);
          });
          ```
        </div>
    </TabItem>
    <TabItem value="mongosh" label="mongosh">
        <div>
          ```js
          db.books.find({ "genres": "History" }, { _id: 0, authors: 0 });
          ```
        </div>
    </TabItem>
     <TabItem value="csharp" label="C#">
      <div>
        ```csharp
          var historyGenre = Builders<Book>.Filter.AnyEq(b => b.Genres, "History");
          var projection = Builders<Book>.Projection.Exclude(b => b.Id).Exclude(b => b.Authors);

          List<Book> sortedBooks = booksCollection.Find(historyGenre)
            .Project<Book>(projection).Limit(50).ToList();

          if(sortedBooks != null)
          {
              foreach(var book in sortedBooks)
              {
                Console.WriteLine(book.ToJson()); // Shows the entire BSON document as JSON to show that some fields are null because they are not returned due to the projection
              }
          }
          else
          {
            Console.WriteLine("Empty Collection");
          }
```
      </div>
    </TabItem>
  </Tabs>
</details>
