import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# üëê INSERT ‚Üí insertOne() & DELETE ‚Üí deleteOne()

MongoDB provides two methods for inserting documents into a collection:

- `.insertOne()`: Inserts a single document
- `.insertMany()`: Inserts multiple documents at once

And just like insert, MongoDB provides:

- `.deleteOne()`: Deletes the first matching document.
- `.deleteMany()`: Deletes all matching documents.

## Example: Insert a new review

```js
db.reviews.insertOne({
  text: "Best book I have ever read.",
  rating: 5,
  name: "Jack",
  bookId: "0786222727",
});
```

### Equivalent SQL query

```sql
INSERT INTO reviews (text, rating, name, bookId)
VALUES ('Best book I have ever read.', 5, 'Jack', '0786222727');
```

## Example: Insert multiple reviews

```js
db.reviews.insertMany([
  {
    text: "Amazing plot.",
    rating: 5,
    name: "John",
    bookId: "0786222727",
  },
  {
    text: "Over-hyped, tbh I feel it's very boring!",
    rating: 2,
    name: "Nick",
    bookId: "0786222727",
  },
]);
```

## Example: Delete one review

```js
db.reviews.deleteOne({
  bookId: "0786222727",
});
```

### Equivalent SQL query

```sql
DELETE FROM reviews WHERE bookId = '0786222727';
```

## Challenge

### üëê 1. Insert 4 more reviews for `bookId` "0786222727".

<details>
  <summary>Answer</summary>
    <Tabs groupId="challenges" defaultValue={"javascript"}>
    <TabItem value="javascript" label="JavaScript">
      <div>
          ```js
          const reviews = db.collection("reviews");
          await reviews.insertMany([
            {
              text: "Thrilling end.",
              rating: 4,
              name: "Mark",
              bookId: "0786222727",
            },
            {
              text: "Must read!",
              rating: 5,
              name: "Raj",
              bookId: "0786222727",
            },
            {
              text: "Very expensive",
              rating: 3,
              name: "Yun",
              bookId: "0786222727",
            },
            {
              text: "Extremely satisfied with the storyline!",
              rating: 5,
              name: "Lisa",
              bookId: "0786222727",
            }
          ]);
          ```
        </div>
    </TabItem>
    <TabItem value="mongosh" label="mongosh">
          <div>
            ```js
            db.reviews.insertMany([
              {
                text: "Thrilling end.",
                rating: 4,
                name: "Mark",
                bookId: "0786222727",
              },
              {
                text: "Must read!",
                rating: 5,
                name: "Raj",
                bookId: "0786222727",
              },
              {
                text: "Very expensive",
                rating: 3,
                name: "Yun",
                bookId: "0786222727",
              },
              {
                text: "Extremely satisfied with the storyline!",
                rating: 5,
                name: "Lisa",
                bookId: "0786222727",
              }
            ]);
            ```
          </div>
      </TabItem>
      <TabItem value="csharp" label="C#">
          <div>
            ```csharp
           var newReviews = new[]
            {
                new Review { Text = "Thrilling end.", Rating = 4, Name = "Mark", BookId = "0786222727" },
                new Review { Text = "Must read!", Rating = 5, Name = "Raj",  BookId = "0786222727" },
                new Review { Text = "Very expensive", Rating = 3, Name = "Yun",  BookId = "0786222727" },
                new Review { Text = "Extremely satisfied with the storyline!", Rating = 5, Name = "Lisa", BookId = "0786222727" }
            };

            reviewsCollection.InsertMany(newReviews);
            ```
          </div>
       </TabItem><TabItem value="Java" label="Java">
      <div>
        ```Java
        var reviews = library.getCollection("reviews");

        reviews.insertMany(List.of(
                new Document("text", "Thrilling end.")
                        .append("rating", 4)
                        .append("name", "Mark")
                        .append("bookId", "0786222727"),

                new Document("text", "Very expensive")
                        .append("rating", 3)
                        .append("name", "Yun")
                        .append("bookId", "0786222727"),

                new Document("text", "Must read!.")
                        .append("rating", 6)
                        .append("name", "Raj")
                        .append("bookId", "0786222727"),

                new Document("text", "Extremely satisfied with the storyline!")
                        .append("rating", 5)
                        .append("name", "Lisa")
                        .append("bookId", "0786222727")));
        ```
      </div>
    </TabItem>
  </Tabs>
</details>

### üëê 2. Delete all the reviews for `bookId` "0786222727" through a single command.

<details>
  <summary>Answer</summary>
  <Tabs groupId="challenges" defaultValue={"javascript"}>
    <TabItem value="javascript" label="JavaScript">
      <div>
          ```js
          const reviews = db.collection("reviews");
          await reviews.deleteMany({"bookId": "0786222727"})
          ```
        </div>
    </TabItem>
    <TabItem value="mongosh" label="mongosh">
          <div>
            ```js
            db.reviews.deleteMany({"bookId": "0786222727"})
            ```
          </div>
    </TabItem>
    <TabItem value="csharp" label="C#">
      <div>
      ```csharp
      IMongoCollection<Review> reviewsCollection = db.GetCollection<Review>("reviews");

      var deletionResult = reviewsCollection.DeleteMany(r => r.BookId == "0786222727");

      Console.WriteLine($"{deletionResult.DeletedCount} review(s) deleted.");
      ```
      </div>
      </TabItem><TabItem value="Java" label="Java">
      <div>
        ```Java
          import static com.mongodb.client.model.Filters.eq;
          import org.bson.conversions.Bson;

          MongoCollection<Document> reviews = library.getCollection("reviews");

          Bson filter = eq("bookId", "0786222727");

          DeleteResult result = reviews.deleteMany(filter);
          System.out.println(result.getDeletedCount() + " reviews deleted.");
        ```
      </div>
    </TabItem>
  </Tabs>
</details>
